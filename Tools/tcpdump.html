<!DOCTYPE HTML>
<html>
    <head>
        <link rel="Stylesheet" type="text/css" href="/static/css/typo.css">
        <link rel="Stylesheet" type="text/css" href="/static/css/reset_typo.css">
        <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
        <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
        <title>tcpdump - My Personal Wiki Site</title>
        <meta name="keywords" content="wiki, linux, python"/>
        <meta name="description" content="ferstar's personal wiki, powered by vim and markdown. Focus on Python, Linux, Ops-Dev etc."/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        
<script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.js"></script>
<script language="javascript" type="text/javascript">
    var oddClick = true;
    $(document).ready(function() {
      $('#toggle-button').click(function() {
        $('#container').animate({
          width: oddClick? "100%":"60%",
        });
        $(this).text(oddClick? "窄版":"宽版");
        oddClick = !oddClick;
      });
    });
</script>

    </head>

    <body>
        <div id="container" class="typo">
            
    <div id="header">
        <div id="post-nav">
            <div id="toggle-button">宽版</div>
            
            <a href="/">Home</a> » <a href="/#Tools">Tools</a> » tcpdump
            
        </div>
    </div>
    <div class="clearfix"></div>
    <div id="content">
        <p>TODO</p>
<p>tcpdump is a common packet analyzer that runs under the command line</p>
<h2 id="_1">语法</h2>
<p>Syntax: 
| Protocol | Direction | Host(s) | Value | Logical Operations | Other expression |</p>
<p>Example:
| tcp | dst | 10.1.1.1 | 80 | and | tcp dst 10.2.2.2 3128 |</p>
<p>== Protocol: ==
Values: ether, fddi, ip, arp, rarp, decnet, lat, sca, moprc, mopdl, tcp and udp.</p>
<p>If no protocol is specified, all the protocols are used. </p>
<p>== Direction: ==
Values: src, dst, src and dst, src or dst</p>
<p>If no source or destination is specified, the "src or dst" keywords are applied. </p>
<p>For example, "host 10.2.2.2" is equivalent to "src or dst host 10.2.2.2".</p>
<p>== Host(s): ==
Values: net, port, host, portrange.</p>
<p>If no host(s) is specified, the "host" keyword is used.</p>
<p>For example, "src 10.1.1.1" is equivalent to "src host 10.1.1.1". </p>
<p>== Logical Operations: ==
Values: not, and, or.</p>
<p>Negation ("not") has highest precedence. Alternation ("or") and concatenation ("and") have equal precedence and associate left to right.</p>
<p>For example,</p>
<p>"not tcp port 3128 and tcp port 23" is equivalent to "(not tcp port 3128) and tcp port 23".</p>
<p>"not tcp port 3128 and tcp port 23" is NOT equivalent to "not (tcp port 3128 and tcp port 23)".</p>
<p>= Arguments =</p>
<p>== -A ==
print in ASCII</p>
<p>== -c ==
Specify the receive count </p>
<p>== -D ==
Print the list of the network interfaces available on the system and on which tcpdump can capture packets</p>
<p>== -i ==
Listen on interface</p>
<p>== -l ==</p>
<blockquote>
<blockquote>
<p>tcpdump -l | tee dat</p>
</blockquote>
</blockquote>
<p>== -n ==
Don't convert addresses to names</p>
<p>== -v/-vv ==</p>
<p>= Read More =</p>
<ul>
<li><a href="http://openmaniak.com/tcpdump.php TCPDUMP">The Easy Tutorial</a></li>
<li><a href="http://www.ha97.com/4550.html">Linux抓包工具tcpdump详解</a></li>
<li><a href="http://www.cnblogs.com/ggjucheng/archive/2012/01/14/2322659.html">Linux tcpdump命令详解</a></li>
<li><a href="http://danielmiessler.com/study/tcpdump/">A tcpdump Tutorial and Primer</a></li>
<li><a href="http://www.tecmint.com/12-tcpdump-commands-a-network-sniffer-tool/">12 Tcpdump Commands – A Network Sniffer Tool</a></li>
<li><a href="http://en.wikipedia.org/wiki/Tcpdump">wiki-tcpdump</a>
http://www.alexonlinux.com/tcpdump-for-dummies
http://www.carnal0wnage.com/papers/TCPdumpBasics.pdf
http://science.hamptonu.edu/compsci/docs/iac/packet_sniffing.pdf
http://www.danielmiessler.com/study/tcpdump/</li>
</ul>
<h2 id="ipv6">ipv6</h2>
<p>for tcp ipv6</p>
<div class="hlcode"><pre><span class="n">sudo</span> <span class="n">tcpdump</span> <span class="o">-</span><span class="n">p</span> <span class="o">-</span><span class="n">i</span> <span class="n">any</span> <span class="n">tcp</span> <span class="n">and</span> <span class="n">port</span> <span class="mi">8000</span> <span class="n">and</span> <span class="n">ip6</span>
</pre></div>


<p>for tcp ipv4 or ipv6:</p>
<div class="hlcode"><pre><span class="n">sudo</span> <span class="n">tcpdump</span> <span class="o">-</span><span class="n">p</span> <span class="o">-</span><span class="n">i</span> <span class="n">any</span> <span class="n">tcp</span> <span class="n">and</span> <span class="n">port</span> <span class="mi">8000</span> <span class="n">and</span> <span class="err">&#39;</span><span class="p">(</span><span class="n">ip</span> <span class="n">or</span> <span class="n">ip6</span><span class="p">)</span><span class="err">&#39;</span>
</pre></div>


<p>for icmp ipv6</p>
<div class="hlcode"><pre><span class="n">sudo</span> <span class="n">tcpdump</span> <span class="o">-</span><span class="n">p</span> <span class="o">-</span><span class="n">i</span> <span class="n">any</span> <span class="n">icmp6</span>
</pre></div>


<p>= History =
Create 2013/01/13</p>
<p>Last modified 2013/01/13</p>
    </div>

        </div>
        <div id="footer">
              <p>
                Copyright © 2012-2016 <a href="http://ferstar.org/" target="_blank">ferstar</a>.
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
                Theme by <a href="https://github.com/tankywoo/yasimple" target="_blank">YASimple</a>.
              </p>
               <p>Last Update 2016-01-25</p>
        </div>
    </body>
</html>