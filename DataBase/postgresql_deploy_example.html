<!DOCTYPE HTML>
<html>
    <head>
        <link rel="Stylesheet" type="text/css" href="/static/css/typo.css">
        <link rel="Stylesheet" type="text/css" href="/static/css/reset_typo.css">
        <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
        <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
        <title>PostgreSQL - My Personal Wiki Site</title>
        <meta name="keywords" content="wiki, linux, python"/>
        <meta name="description" content="ferstar's personal wiki, powered by vim and markdown. Focus on Python, Linux, Ops-Dev etc."/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        
<script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.js"></script>
<script language="javascript" type="text/javascript">
    var oddClick = true;
    $(document).ready(function() {
      $('#toggle-button').click(function() {
        $('#container').animate({
          width: oddClick? "100%":"60%",
        });
        $(this).text(oddClick? "窄版":"宽版");
        oddClick = !oddClick;
      });
    });
</script>

    </head>

    <body>
        <div id="container" class="typo">
            
    <div id="header">
        <div id="post-nav">
            <div id="toggle-button">宽版</div>
            
            <a href="/">Home</a> » <a href="/#DataBase">DataBase</a> » PostgreSQL
            
        </div>
    </div>
    <div class="clearfix"></div>
    <div id="content">
        <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#_1">关于</a></li>
<li><a href="#create-test-db">Create Test DB</a></li>
<li><a href="#deploy-db">Deploy DB</a><ul>
<li><a href="#install">install</a></li>
<li><a href="#change-default-data-directory">change default data directory</a></li>
<li><a href="#authentication-security">authentication security</a></li>
</ul>
</li>
</ul>
</div>
<h2 id="_1">关于</h2>
<p>PostgreSQL 是自由的对象-关系型数据库服务器（数据库管理系统），在灵活的BSD-风格许可证下发行。它在其他开放源代码数据库系统（比如 MySQL 和 Firebird），和专有系统比如 Oracle、Sybase、IBM 的 DB2 和 Microsoft SQL Server 之外，为用户又提供了一种选择。</p>
<p>PostgreSQL 不寻常的名字导致一些读者停下来尝试拼读它，特别是那些把 SQL 拼读为"sequel"的人。PostgreSQL 开发者把它拼读为"post-gress-Q-L"。它也经常被简略念为"postgres"。</p>
<blockquote>
<p>以上介绍转自 <a href="https://zh.wikipedia.org/wiki/PostgreSQL">https://zh.wikipedia.org/wiki/PostgreSQL</a> </p>
</blockquote>
<h2 id="create-test-db">Create Test DB</h2>
<div class="hlcode"><pre><span class="n">postgres</span><span class="o">=</span><span class="err">#</span> <span class="n">create</span> <span class="n">user</span> <span class="n">test</span> <span class="n">encrypted</span> <span class="n">password</span> <span class="err">&#39;</span><span class="n">test</span><span class="err">&#39;</span><span class="p">;</span>
<span class="n">CREATE</span> <span class="n">ROLE</span>
<span class="n">postgres</span><span class="o">=</span><span class="err">#</span> <span class="n">create</span> <span class="n">database</span> <span class="n">test</span> <span class="n">owner</span> <span class="n">test</span><span class="p">;</span>
<span class="n">CREATE</span> <span class="n">DATABASE</span>
<span class="n">postgres</span><span class="o">=</span><span class="err">#</span> <span class="n">GRANT</span> <span class="n">ALL</span> <span class="n">PRIVILEGES</span> <span class="n">ON</span> <span class="n">DATABASE</span> <span class="n">test</span> <span class="n">to</span> <span class="n">test</span><span class="p">;</span>
<span class="n">GRANT</span>
<span class="n">postgres</span><span class="o">=</span><span class="err">#</span> <span class="n">alter</span> <span class="n">role</span> <span class="n">test</span> <span class="n">in</span> <span class="n">database</span> <span class="n">test</span> <span class="n">set</span> <span class="n">search_path</span><span class="o">=</span><span class="n">test</span><span class="p">;</span>
<span class="n">ALTER</span> <span class="n">ROLE</span>
</pre></div>


<h2 id="deploy-db">Deploy DB</h2>
<h3 id="install">install</h3>
<div class="hlcode"><pre><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">postgresql</span> <span class="n">postgresql</span><span class="o">-</span><span class="n">contrib</span> <span class="n">postgresql</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">dev</span><span class="o">-</span><span class="mf">9.</span><span class="o">*</span>
</pre></div>


<h3 id="change-default-data-directory">change default data directory</h3>
<div class="hlcode"><pre><span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="mf">9.</span><span class="err">*/</span><span class="n">data</span>
<span class="n">chown</span> <span class="o">-</span><span class="n">R</span> <span class="n">postgres</span><span class="o">:</span><span class="n">postgres</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="mf">9.</span><span class="err">*/</span><span class="n">data</span>
<span class="n">chmod</span> <span class="o">-</span><span class="n">R</span> <span class="mo">0700</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="mf">9.</span><span class="err">*/</span><span class="n">data</span>
<span class="n">su</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">u</span> <span class="n">postgres</span>
<span class="n">sudo</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">postgresql</span><span class="o">/</span><span class="mf">9.</span><span class="err">*/</span><span class="n">bin</span><span class="o">/</span><span class="n">initdb</span> <span class="o">-</span><span class="n">D</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="mf">9.</span><span class="err">*/</span><span class="n">data</span> <span class="o">-</span><span class="n">E</span> <span class="n">UTF8</span>
</pre></div>


<h3 id="authentication-security">authentication security</h3>
<ul>
<li>config file path</li>
</ul>
<p><code>/etc/postgresql/9.*/main/postgresql.conf</code></p>
<ul>
<li>FILE LOCATIONS &amp; Connection Settings</li>
</ul>
<div class="hlcode"><pre><span class="n">data_directory</span> <span class="o">=</span> <span class="err">&#39;</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="mf">9.</span><span class="err">*/</span><span class="n">data</span><span class="err">&#39;</span>
<span class="n">hba_file</span> <span class="o">=</span> <span class="err">&#39;</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="mf">9.</span><span class="err">*/</span><span class="n">data</span><span class="o">/</span><span class="n">pg_hba</span><span class="p">.</span><span class="n">conf</span><span class="err">&#39;</span>
<span class="n">ident_file</span> <span class="o">=</span> <span class="err">&#39;</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="mf">9.</span><span class="err">*/</span><span class="n">data</span><span class="o">/</span><span class="n">pg_ident</span><span class="p">.</span><span class="n">conf</span><span class="err">&#39;</span>
<span class="n">listen_addresses</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">localhost</span><span class="err">&#39;</span>          <span class="err">#</span> <span class="n">defaults</span> <span class="n">to</span> <span class="err">&#39;</span><span class="n">localhost</span><span class="err">&#39;</span><span class="p">;</span> <span class="n">use</span> <span class="sc">&#39;*&#39;</span> <span class="n">to</span> <span class="n">listen</span> <span class="n">all</span>
<span class="n">max_connections</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">ssl</span> <span class="o">=</span> <span class="nb">false</span>
<span class="n">password_encryption</span> <span class="o">=</span> <span class="n">on</span>
</pre></div>
    </div>

        </div>
        <div id="footer">
              <p>
                Copyright © 2012-2016 <a href="http://ferstar.org/" target="_blank">ferstar</a>.
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
                Theme by <a href="https://github.com/tankywoo/yasimple" target="_blank">YASimple</a>.
              </p>
               <p>Last Update 2016-01-26</p>
        </div>
    </body>
</html>